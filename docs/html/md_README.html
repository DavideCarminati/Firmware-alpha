<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>My Project: Firmware alpha</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">My Project
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Firmware alpha </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>This repository is an open-source autopilot developed with PlatformIO and Visual Studio Code. It is compatible with <a href="https://os.mbed.com/mbed-os/">ARM&reg; Mbed&trade; OS</a> and makes use of its APIs. The autopilot is tested on a <a href="https://os.mbed.com/platforms/FRDM-K64F/">NXP FRDM-K64F</a> board. </p><h2>Processor-In-the-Loop (PIL)</h2>
<p><em>Processor-In-the-Loop</em> validation allows the developer to test the software directly on the target board. The board is connected with an external PC on which is running the physical model of the robot as well as a model of its actuators and sensors. This firmware supports communication using the <b>UDP</b> protocol to talk with the external PC. The connection properties (e.g. IP, Port...) can be modified in the file <em>UDPComm.cpp</em>: </p><div class="fragment"><div class="line">{c++}</div><div class="line">static const char*          mbedIP       = &quot;192.168.1.55&quot;;      // This board IP seen from the network</div><div class="line">static const char*          mbedMask     = &quot;255.255.255.0&quot;;     // Mask</div><div class="line">static const char*          mbedGateway  = &quot;192.168.1.254&quot;;     // Gateway</div><div class="line"></div><div class="line">static const char*          recvIP = &quot;192.168.1.203&quot;;           // External PC IP */ &quot;192.168.1.249&quot;;</div><div class="line">static const char*          localIP = &quot;0.0.0.0&quot;;                // Local IP on which the server of the board listens</div></div><!-- fragment --><p> The messaging protocol used is <a href="https://mavlink.io/en/">Mavlink v2.0</a> since it is lightweight, open-source and widespread. </p><h3>PIL with Matlab/Simulink&reg;</h3>
<p>It is possible to employ Simulink to create the robot model</p>
<h2>Code generation with Matlab/Simulink&reg;</h2>
<p>For <em>Rapid Prototyping</em> purposes, code generation is a valid tool. The Firmware is compatible with C/C++ code automatically generated from Matlab/Simulink&reg;. Here general rules and the settings used in the <b>Model Configuration Parameter</b> pane are shown so that scripts generated by the embedded coder in Simulink are compatible with the Firmware. </p><h4>General rules</h4>
<p>The following general rules have to be taken into account when creating the Simulink model:</p><ul>
<li>To match the variable names in the Firmware, the Simulink model has to be named "*feedback_control.slx*", so that input and output variables are structs named respectively <em>feedback_control_U</em> and <em>feedback_control_Y</em>;</li>
<li>The <b>In1</b> and <b>Out1</b> ports in Simulink has to be carefully named since the arguments of the C++ controller step function are structs whose members take the name from those ports. <h4>Interface</h4>
</li>
</ul>
<h3>Firmware with generated code</h3>
<p>The generated code can be easily added to the Firmware by doing a copy and paste of the header files into the <em>include</em> folder and the source files into the <em>src</em> folder. Then, few modifications have to be done to make the Firmware compatible with some generated code:</p><ul>
<li>Look throughout the scripts depending on the header <em><a class="el" href="global__vars_8hpp.html" title="Header gathering the global variables used in the Firmware. ">global_vars.hpp</a></em> and add the <em>feedback_control_U</em> and <em>feedback_control_Y</em> structs </li>
</ul>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
